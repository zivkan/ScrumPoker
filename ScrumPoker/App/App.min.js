(function(){"use strict";var n=angular.module("scrumPokerApp",["ngRoute","ui.bootstrap","scrumPokerControllers"]);n.config(["$routeProvider",function(n){n.when("/",{templateUrl:"partials/lobby.html",controller:"lobby"}).when("/room/:roomId",{templateUrl:"partials/room.html",controller:"room"}).otherwise({redirectTo:"/"})}])})(),function(){"use strict";angular.module("scrumPokerControllers",[])}(),function(){"use strict";angular.module("scrumPokerControllers").controller("connection",["$scope","$modalInstance","PokerServer",function(n,t,i){n.PokerServer=i;var r=function(n){return n==$.connection.connectionState.connecting?"connecting":n==$.connection.connectionState.reconnecting?"reconnecting":n==$.connection.connectionState.disconnected?"disconnected":n==$.connection.connectionState.connected?"connected":"unknown state"};n.connectionState=r($.connection.hub.state);$.connection.hub.stateChanged(function(t){n.connectionState=r(t.newState);n.$apply()})}])}(),function(){"use strict";angular.module("scrumPokerControllers").controller("lobby",["$scope","PokerServer",function(n,t){n.server=t;n.rooms=null;t.Reconnect().then(function(){t.getRooms().then(function(t){n.rooms=t},function(){n.error="an error happened"})});t.$on("roomAdded",function(t,i){n.$apply(function(){n.rooms!=null&&n.rooms.push(i)})});t.$on("roomDeleted",function(t,i){for(var r=0;r<n.rooms.length;r++)if(n.rooms[r].Id===i){n.$apply(function(){n.rooms.splice(r,1)});break}})}])}(),function(){"use strict";angular.module("scrumPokerApp").factory("PokerServer",["$rootScope","$location","$modal","$q",function(n,t,i,r){var u=n.$new(),f,e;return u.currentRoom=null,f=$.connection.lobbyHub,u.getRooms=function(){return r.when(f.server.getRooms())},f.client.roomAdded=function(n){u.$emit("roomAdded",n)},f.client.roomDeleted=function(n){u.$emit("roomDeleted",n)},e=$.connection.roomHub,e.client.roomUpdate=function(t){u.currentRoom!==null&&(u.currentRoom.participants=t,n.$apply())},u.modalInstance=null,$.connection.hub.stateChanged(function(n){n.newState!==$.connection.connectionState.connected?u.modalInstance===null&&(u.modalInstance=i.open({templateUrl:"partials/connection.html",controller:"connection",backdrop:"static"})):u.modalInstance!==null&&(u.modalInstance.dismiss(),u.modalInstance=null)}),u.Reconnect=function(){return r.when($.connection.hub.start())},u.CreateRoom=function(i,r){f.server.createRoom(i,r).done(function(r){r.RoomId!==null&&(u.currentRoom={id:r.RoomId,name:i},u.currentRoom.participants=r.participants,t.path("/room/"+r.RoomId),n.$apply())})},u.JoinRoom=function(i,r){e.server.joinRoom(i,r).done(function(f){u.currentRoom={id:i,username:r,name:"later"};u.currentRoom.participants=f;t.$$path.indexOf("/room/")===-1&&t.path("/room/"+i);n.$apply()})},u.Bet=function(n){e.server.bet(n)},n.$on("$locationChangeStart",function(n,t,i){i.indexOf("/room/")!==-1&&u.currentRoom!==null&&(e.server.leaveRoom(),u.currentRoom=null)}),u}])}(),function(){"use strict";angular.module("scrumPokerControllers").controller("room",["$scope","PokerServer","$routeParams",function(n,t,i){n.server=t;n.roomId=i.roomId;n.$watch("myBet",function(t){t!=null&&(t==="-"&&(t=null),n.server.Bet(t))});n.allowedBets=[0,1,2,3,5,8,13,21,34,55,89]}])}();
/*
//# sourceMappingURL=App.min.js.map
*/